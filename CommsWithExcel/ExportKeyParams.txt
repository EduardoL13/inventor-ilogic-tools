Sub Main () ' v1

' Declarations
Dim invDoc As PartDocument = ThisDoc.Document ' Documento activo

Dim inventorParamList As UserParameters = invDoc.ComponentDefinition.Parameters.UserParameters
Dim noPDS As Integer = inventorParamList.Count ' Insertar número de parámetros que se desean
Dim noListPDS As Integer = noPDS - 1 'Número de parámetros para poner en los arrays


Dim file As String
Dim tab As String

file = "Nombre archivo"
tab = "EIKP"

'Row counter definition
Dim RowCounter As Integer = 2 'Row de inicio para escribir datos


For Each param As UserParameter In inventorParamList
	If param.IsKey = True Then
        If RowCounter = 2 Then
	        GoExcel.CellValue(file, tab, "A" & RowCounter) = param.Name
		    cf = unitsEval(param.Units)
	        GoExcel.CellValue("B" & RowCounter) = param.Value * cf
	        GoExcel.CellValue("C" & RowCounter) = param.Units
    	Else
	        GoExcel.CellValue("A" & RowCounter) = param.Name
			'MsgBox(param.Name)
		    cf = unitsEval(param.Units)
	        GoExcel.CellValue("B" & RowCounter) = param.Value * cf
	        GoExcel.CellValue("C" & RowCounter) = param.Units
		End If
	RowCounter = RowCounter + 1 
	End If
Next

GoExcel.Save
MsgBox("Key parameters have been exported")
End Sub


Function unitsEval(units As String)
If units = "in"
	cf = 1 / 2.54
Else If units = "ul"
	cf = 1
Else
	cf = 10
End If
Return cf
End Function

