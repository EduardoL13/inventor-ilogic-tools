Sub Main ()

Dim currentDoc As AssemblyDocument = ThisDoc.Document

sFile = "Nombre Archivo"
tabDS = "worksheet"
	
Dim lastDataValue As Integer = findLastDataRow(sFile, tabDS) '4 'DefiniciÃ³n de Range 

'-----
setPropertiesAndMat(assemDef, sFile, tabDS, lastDataValue) 
	
End Sub	


Function findLastDataRow(file As String, tab As String)
	Dim cellVal As Object 
	Dim range As Integer = 1000
	Dim lastDataRow As Integer = 0
    For rowNum As Integer = 1 To range
		cellVal = GoExcel.CellValue(file, tab, "A" & rowNum)
	    If cellVal Is Nothing  Then '(cellVal Is Nothing OrElse String.IsNullOrEmpty(cellVal.ToString()))
			If (rowNum > range) Then Exit For
	    Else
			lastDataRow = rowNum + 1
		End If
	Next
	Return lastDataRow
End Function

Sub setPropertiesAndMat(assembComp As AssemblyDocument, file As String, tab As String, lastValue As Integer) 
For Each compOcc As ComponentOccurrence In assembComp.ComponentDefinition.Occurrences.AllLeafOccurrences
    If compOcc.Suppressed Then
	
	Else
	    For rowCounter=2 To lastValue
		Dim nameOccDS As String = GoExcel.CellValue(file, tab, "A" & rowCounter) 
		'MsgBox(compOcc.Name)
		
		'Make sure to put here below the corresponding column letter to the property you want to assign
		
		colPartNo = "M" 'Part Number
		colStockNumber = "N" 'Stock Number
		colDescription = "D" 'Description
		colMaterial = "E" 'Material 
		
		If compOcc.Name = nameOccDS Then
		
        	iProperties.Expression(compOcc.Name, "Project", "Part Number") = GoExcel.CellValue(file, tab, colPartNo & rowCounter)
			iProperties.Expression(compOcc.Name, "Project", "Stock Number") = GoExcel.CellValue(file, tab, colStockNumber & rowCounter)
	    	iProperties.Expression(compOcc.Name, "Project", "Description") = GoExcel.CellValue(file, tab, colDescription & rowCounter)
	    	iProperties.MaterialOfComponent(compOcc.Name) = GoExcel.CellValue(file, tab, colMaterial & rowCounter) ' value for this property should be given the exact way Inventor assigns it when assigning the material manually
		End If
	Next
	End If
	Next

End Sub
