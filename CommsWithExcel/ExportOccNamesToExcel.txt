Sub Main ()

Dim currentDoc As AssemblyDocument = ThisDoc.Document
Dim count As Integer = 0
Dim leafOccurrences As ComponentOccurrencesEnumerator = currentDoc.ComponentDefinition.Occurrences.AllLeafOccurrences

Dim numOccs As Integer = leafOccurrences.Count ' 
'Dim listOccsNames(numOccs) As String  ' Definici√≥n de la variable que se le va a asignar al multiparameter list
Dim listOccsNames As New List(Of String)
Dim listkeyStrings As New List(Of String)


For Each compOccurrence As ComponentOccurrence In leafOccurrences
    If compOccurrence.BOMStructure.ToString = "kNormalBOMStructure" Then	
		nameToCheck = trimName(compOccurrence.Name, 2)
		If listkeyStrings.Contains(nameToCheck) Then
		
		Else
            listOccsNames.Add(compOccurrence.Name)
			listkeyStrings.Add(nameToCheck)
		End If
	End If
Next

Dim sFile As String
Dim tabDS As String

sFile = currentDoc.PropertySets.Item("Spreadsheet Document").Item("File Name").Value
tabDS = currentDoc.PropertySets.Item("Worksheet Data").Item("Worksheet Name").Value	

Dim file As String = sFile
Dim tab As String = tabDS
Dim rowCounter = 2

For Each name As String In listOccsNames
        If rowCounter = 2 Then
            GoExcel.CellValue(file, tab, "A" & rowCounter) = name
        Else
            GoExcel.CellValue("A" & rowCounter) = name
        End If
	    rowCounter = rowCounter + 1   
Next

GoExcel.Save

End Sub


Function trimName (nameToTrim As String, noChar As Integer )

   Dim limSup As Integer = Len(nameToTrim) 
   Dim limInf As Integer = limSup - noChar
   Dim trimmedString As String = nameToTrim
   
   trimmedString = trimmedString.Remove(limInf)
   Return trimmedString
   
End Function

